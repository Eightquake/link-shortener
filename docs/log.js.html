<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: log.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: log.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
  * A module for attaching my own logging functions to the console functions. It acts as a intermediary to add some useful information like date, time and some other useful stuff.
  * @todo Fix so that arguments are printed prettier and try to find a way for the functions to find caller.
  * @module log
  * @author Victor Davidsson
  * @version 0.0.5
  */

let fs = require("fs");

let categories = [];

["log", "warn", "error"].forEach(function(type) {
    var oldMethod = console[type].bind(console);
    console[type] = function() {
        let cat;
        if(categories.indexOf(arguments[0])) {
          cat = arguments[0];
          delete arguments[0];
        }
        let logArray = [].concat(getLogString(type, cat), arguments);
        oldMethod.apply(
            console,
            logArray
        );
        writeLogFile(logArray);
    };
});

/**
  * Adds some useful info to be used while logging.
  * @function
  * @access private
  * @param {String} type - The type of the logging, currently this is based on what console functions is called (log, warn and error)
  * @param {String=} cat - The category of the logging. Doesn't have to be defined, still prints pretty if so.
  * @returns {String} The entire string with date and time, type and maybe category. Each is denoted by a |
  */
function getLogString(type, cat) {
  return (new Date().toLocaleString("sv-SE") + " | " + type.toUpperCase() + "\t|") + ((cat)? " " + cat + "\t|":"");
}

/**
  * A function for registering a category so that the logging function know to omit it as an argument and just have it in the category spot.
  * @function
  * @access public
  * @param {String} cat - The category to be registered
  * @returns {String} The category that was registered or already was registered.
  */
function registerCategory(cat) {
  if(!categories.indexOf(cat)) {
    categories.push(cat);
  }
  return cat;
}

/**
  * A function for writing the same console output to a logfile.
  * @function
  * @access private
  * @param {Array} logArray - The array containing everything to be logged.
  */
function writeLogFile(logArray) {
  let stringArray = logArray[0];
  let argsArray = [...logArray[1]];
  fs.appendFile('log.txt', stringArray + " " + argsArray + "\r\n", (err) => {
    if (err) throw err;
  });
}

module.exports = {
  register: registerCategory
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-file.html">file</a></li><li><a href="module-hash.html">hash</a></li><li><a href="module-log.html">log</a></li><li><a href="module-master.html">master</a></li></ul><h3>Global</h3><ul><li><a href="global.html#logging">logging</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Apr 28 2019 17:11:21 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
